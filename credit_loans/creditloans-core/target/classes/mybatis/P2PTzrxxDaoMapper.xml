<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="cn.creditloans.core.dao.P2PTzrxxDao">
	<resultMap type="cn.creditloans.core.entity.p2p.P2PTzrxx" id="p2pTzrxxResultMap">
		<id property="id" column="id" />
		<result property="tzrxm" column="tzrxm"/>
		<result property="tzrzjlx" column="tzrzjlx"/>
		<result property="tzrzjhm" column="tzrzjhm"/>
		<result property="tzrtzje" column="tzrtzje"/>
		<result property="dkjbxxId" column="dkjbxx_id"/>
		<result property="status" column="status"/>
		<result property="userId" column="user_id"/>
		<result property="orgCode" column="org_code"/>
		<result property="createTime" column="create_time"/>
		<result property="updateTime" column="update_time"/>
	</resultMap>
	
	<sql id="select_all_sql">
		select id, tzrxm, tzrzjlx, tzrzjhm, tzrtzje, dkjbxx_id, status, user_id, org_code, create_time, update_time from p2p_tzrxx
	</sql>
	
	<select id="selectP2PTzrxxPageCount" parameterType="cn.creditloans.core.entity.p2p.P2PTzrxx" resultType="int">
		select count(1) from p2p_tzrxx where org_code = #{orgCode} and dkjbxx_id = #{dkjbxxId}
		<if test="tzrxm != null and '' != tzrxm">  
			and tzrxm like '%${tzrxm}%'
		</if>
		<if test="tzrzjhm != null and '' != tzrzjhm">  
			and tzrzjhm like '%${tzrzjhm}%'
		</if>
		<if test="status != 0">  
			and status = #{status}
		</if>
	</select>
	
	<select id="selectP2PTzrxxPageList" resultMap="p2pTzrxxResultMap">
		<include refid="select_all_sql" />
		where org_code = #{p2pTzrxx.orgCode} and dkjbxx_id = #{p2pTzrxx.dkjbxxId}
		<if test="p2pTzrxx.tzrxm != null and '' != p2pTzrxx.tzrxm">  
			and tzrxm like '%${p2pTzrxx.tzrxm}%'
		</if>
		<if test="p2pTzrxx.tzrzjhm != null and '' != p2pTzrxx.tzrzjhm">  
			and tzrzjhm like '%${p2pTzrxx.tzrzjhm}%'
		</if>
		<if test="p2pTzrxx.status != 0">  
			and status = #{p2pTzrxx.status}
		</if>
		order by create_time desc limit #{pm.pageSize} offset #{pm.startCount}
	</select>
	
	<select id="selectP2PTzrxxById" parameterType="int" resultMap="p2pTzrxxResultMap">
		<include refid="select_all_sql" />
		where id = #{id}
	</select>
	
	<select id="selectP2PTzrxxCountForUnique" parameterType="map" resultType="int">
		select count(1) from p2p_tzrxx where tzrzjlx = #{tzrzjlx} and tzrzjhm = #{tzrzjhm} and dkjbxx_id = #{dkjbxxId} and org_code = #{orgCode}
	</select>
	
	<insert id="insertP2PTzrxx" parameterType="cn.creditloans.core.entity.p2p.P2PTzrxx">
		<selectKey order="AFTER" keyProperty="id" resultType="java.lang.Integer">
			SELECT currval('p2p_tzrxx_id_seq')
		</selectKey>
		insert into p2p_tzrxx (tzrxm, tzrzjlx, tzrzjhm, tzrtzje, dkjbxx_id,
		status, user_id, org_code, create_time, update_time)
		values (#{tzrxm}, #{tzrzjlx}, #{tzrzjhm}, #{tzrtzje}, #{dkjbxxId},
		#{status}, #{userId}, #{orgCode}, now(), now())
	</insert>
	
	<update id="updateP2PTzrxx" parameterType="cn.creditloans.core.entity.p2p.P2PTzrxx">
		update p2p_tzrxx set tzrxm=#{tzrxm}, tzrzjlx=#{tzrzjlx}, tzrzjhm=#{tzrzjhm},
		tzrtzje=#{tzrtzje}, dkjbxx_id=#{dkjbxxId}, status=#{status},
		user_id=#{userId}, org_code=#{orgCode}, update_time=now() where id=#{id}
	</update>
	
	<delete id="deleteP2PTzrxxById" parameterType="int">
		delete from p2p_tzrxx where id=#{id}
	</delete>
</mapper>