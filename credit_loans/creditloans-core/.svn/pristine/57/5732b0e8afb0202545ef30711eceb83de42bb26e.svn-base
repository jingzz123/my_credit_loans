package cn.creditloans.core.service.impl.af;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import cn.creditloans.core.dao.af.BaseElementDao;
import cn.creditloans.core.dao.af.RulesetElementDao;
import cn.creditloans.core.dto.af.BaseElementDTO;
import cn.creditloans.core.entity.af.BaseElement;
import cn.creditloans.core.service.BaseElementService;
import cn.creditloans.tools.page.PageModel;
@Service("baseElementServie")
public class BaseElementServiceImpl implements BaseElementService {
	private static final Log logger = LogFactory.getLog(BaseElementServiceImpl.class);
	@Autowired
	BaseElementDao baseElementDao;
	@Autowired
	RulesetElementDao rulesetElementDao;
	
	@Override
	public PageModel<BaseElementDTO> getBaseElementPageList(
			BaseElementDTO baseElementDTO, int currentPage, int pageSize) {
		BaseElement baseElement = new BaseElement();
		BeanUtils.copyProperties(baseElementDTO, baseElement);
		
		PageModel<BaseElementDTO> pm = new PageModel<BaseElementDTO>();
		pm.init(currentPage, pageSize);
		int count = baseElementDao.selectPageCount(baseElement);
		List<BaseElement> baseElementList = baseElementDao.selectPageList(baseElement, pm);
		List<BaseElementDTO> baseElementDtoList = new ArrayList<BaseElementDTO>();
		for(BaseElement _baseElement : baseElementList){
			BaseElementDTO _baseElementDTO = new BaseElementDTO();
			BeanUtils.copyProperties(_baseElement, _baseElementDTO);
			baseElementDtoList.add(_baseElementDTO);
		}
		
		pm.setTotal(count);
		pm.setDatas(baseElementDtoList);
		return pm;
	}

	@Override
	public int saveBaseElement(BaseElementDTO baseElementDTO) {
		BaseElement baseElement = new BaseElement();
		BeanUtils.copyProperties(baseElementDTO, baseElement);
		baseElementDao.insert(baseElement);
		int elementId = baseElement.getId();
		return elementId;
	}

	@Override
	public BaseElementDTO getBaseElementById(int elementId) {
		BaseElementDTO baseElementDTO = new BaseElementDTO();
		BaseElement baseElement = baseElementDao.select(elementId);
		BeanUtils.copyProperties(baseElement, baseElementDTO);
		return baseElementDTO;
	}

	@Override
	public void updateBaseElement(BaseElementDTO baseElementDTO) {
		BaseElement baseElement = new BaseElement();
		BeanUtils.copyProperties(baseElementDTO, baseElement);
		baseElementDao.update(baseElement);
	}

	@Override
	public void deleteBaseElement(int elementId) {
		baseElementDao.delete(elementId);
	}

	@Override
	public List<BaseElementDTO> selectAllInfos() {
		List<BaseElement> baseElementList = baseElementDao.selectAllInfos();
		List<BaseElementDTO> baseElementDTOList = new  ArrayList<BaseElementDTO>();
		for(BaseElement _baseElement : baseElementList){
			BaseElementDTO _baseElementDTO = new BaseElementDTO();
			BeanUtils.copyProperties(_baseElement, _baseElementDTO);
			baseElementDTOList.add(_baseElementDTO);
		}
		return baseElementDTOList;
	}
}
