<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="cn.creditloans.core.dao.P2PDksqxxDao">
	<resultMap type="cn.creditloans.core.entity.p2p.P2PDksqxx" id="p2pDksqxxResultMap">
		<id property="id" column="id" />
		<result property="dksqh" column="dksqh"/>
		<result property="xm" column="xm"/>
		<result property="zjlx" column="zjlx"/>
		<result property="zjhm" column="zjhm"/>
		<result property="dksqlx" column="dksqlx"/>
		<result property="dksqje" column="dksqje"/>
		<result property="dksqys" column="dksqys"/>
		<result property="dksqsj" column="dksqsj"/>
		<result property="dksqzt" column="dksqzt"/>
		<result property="status" column="status"/>
		<result property="userId" column="user_id"/>
		<result property="orgCode" column="org_code"/>
		<result property="createTime" column="create_time"/>
		<result property="updateTime" column="update_time"/>
		<result property="dksqzqdw" column="dksqzqdw"/>
		<result property="dksqzq" column="dksqzq"/>
	</resultMap>
	
	<sql id="select_all_sql">
		select id, dksqh, xm, zjlx, zjhm, dksqlx, dksqje, dksqys, dksqsj,
		 dksqzt, status, user_id, org_code, create_time, update_time, dksqzqdw, dksqzq from p2p_dksqxx
	</sql>
	
	<select id="selectP2PDksqxxPageCount" parameterType="cn.creditloans.core.entity.p2p.P2PDksqxx" resultType="int">
		select count(1) from p2p_dksqxx where org_code = #{orgCode}
		<if test="dksqh != null and '' != dksqh">  
			and dksqh like '%${dksqh}%'
		</if>
		<if test="xm != null and '' != xm">  
			and xm like '%${xm}%'
		</if>
		<if test="zjhm != null and '' != zjhm">  
			and zjhm like '%${zjhm}%'
		</if>
		<if test="dksqlx != null and '' != dksqlx">  
			and dksqlx = #{dksqlx}
		</if>
		<if test="dksqzt != null and '' != dksqzt">  
			and dksqzt = #{dksqzt}
		</if>
		<if test="status != 0">  
			and status = #{status}
		</if>
	</select>
	
	<select id="selectP2PDksqxxPageList" resultMap="p2pDksqxxResultMap">
		<include refid="select_all_sql" />
		where org_code = #{p2pDksqxx.orgCode}
		<if test="p2pDksqxx.dksqh != null and '' != p2pDksqxx.dksqh">  
			and dksqh like '%${p2pDksqxx.dksqh}%'
		</if>
		<if test="p2pDksqxx.xm != null and '' != p2pDksqxx.xm">  
			and xm like '%${p2pDksqxx.xm}%'
		</if>
		<if test="p2pDksqxx.zjhm != null and '' != p2pDksqxx.zjhm">  
			and zjhm like '%${p2pDksqxx.zjhm}%'
		</if>
		<if test="p2pDksqxx.dksqlx != null and '' != p2pDksqxx.dksqlx">  
			and dksqlx = #{p2pDksqxx.dksqlx}
		</if>
		<if test="p2pDksqxx.dksqzt != null and '' != p2pDksqxx.dksqzt">  
			and dksqzt = #{p2pDksqxx.dksqzt}
		</if>
		<if test="p2pDksqxx.status != 0">  
			and status = #{p2pDksqxx.status}
		</if>
		order by create_time desc limit #{pm.pageSize} offset #{pm.startCount}
	</select>
	
	<select id="selectP2PDksqxxById" parameterType="int" resultMap="p2pDksqxxResultMap">
		<include refid="select_all_sql" />
		where id = #{id}
	</select>
	
	<select id="selectP2PDksqxxCountForUnique" parameterType="map" resultType="int">
		select count(1) from p2p_dksqxx where dksqh = #{dksqh} and org_code = #{orgCode}
	</select>
	
	<insert id="insertP2PDksqxx" parameterType="cn.creditloans.core.entity.p2p.P2PDksqxx">
		<selectKey order="AFTER" keyProperty="id" resultType="java.lang.Integer">
			SELECT currval('p2p_dksqxx_id_seq')
		</selectKey>
		insert into p2p_dksqxx (dksqh, xm, zjlx, zjhm, dksqlx, dksqje, dksqys,
		dksqsj, dksqzt, status, user_id, org_code, create_time, update_time, dksqzqdw, dksqzq)
		values (#{dksqh}, #{xm}, #{zjlx}, #{zjhm}, #{dksqlx}, #{dksqje},
		#{dksqys}, #{dksqsj}, #{dksqzt}, #{status}, #{userId}, #{orgCode},
		now(), now(), #{dksqzqdw}, #{dksqzq})
	</insert>
	
	<update id="updateP2PDksqxx" parameterType="cn.creditloans.core.entity.p2p.P2PDksqxx">
		update p2p_dksqxx set dksqh=#{dksqh}, xm=#{xm}, zjlx=#{zjlx}, zjhm=#{zjhm},
		dksqlx=#{dksqlx}, dksqje=#{dksqje}, dksqys=#{dksqys}, dksqsj=#{dksqsj},
		dksqzt=#{dksqzt}, status=#{status}, user_id=#{userId},
		org_code=#{orgCode}, update_time=now(), dksqzqdw=#{dksqzqdw}, dksqzq=#{dksqzq} where id=#{id}
	</update>
	
	<delete id="deleteP2PDksqxxById" parameterType="int">
		delete from p2p_dksqxx where id=#{id}
	</delete>
</mapper>