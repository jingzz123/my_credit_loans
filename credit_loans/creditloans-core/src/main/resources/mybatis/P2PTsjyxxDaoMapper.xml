<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="cn.creditloans.core.dao.P2PTsjyxxDao">
	<resultMap type="cn.creditloans.core.entity.p2p.P2PTsjyxx" id="p2pTsjyxxResultMap">
		<id property="id" column="id" />
		<result property="xm" column="xm"/>
		<result property="zjlx" column="zjlx"/>
		<result property="zjhm" column="zjhm"/>
		<result property="ywh" column="ywh"/>
		<result property="tsjylx" column="tsjylx"/>
		<result property="fsrq" column="fsrq"/>
		<result property="bgys" column="bgys"/>
		<result property="fsje" column="fsje"/>
		<result property="mxxx" column="mxxx"/>
		<result property="status" column="status"/>
		<result property="userId" column="user_id"/>
		<result property="orgCode" column="org_code"/>
		<result property="createTime" column="create_time"/>
		<result property="updateTime" column="update_time"/>
	</resultMap>
	
	<sql id="select_all_sql">
		select id, xm, zjlx, zjhm, ywh, tsjylx, fsrq, bgys, fsje,
		 mxxx, status, user_id, org_code, create_time, update_time from p2p_tsjyxx
	</sql>
	
	<select id="selectP2PTsjyxxPageCount" parameterType="cn.creditloans.core.entity.p2p.P2PTsjyxx" resultType="int">
		select count(1) from p2p_tsjyxx where org_code = #{orgCode}
		<if test="xm != null and '' != xm">  
			and xm like '%${xm}%'
		</if>
		<if test="zjhm != null and '' != zjhm">  
			and zjhm like '%${zjhm}%'
		</if>
		<if test="ywh != null and '' != ywh">  
			and ywh like '%${ywh}%'
		</if>
		<if test="tsjylx != null and '' != tsjylx">  
			and tsjylx = #{tsjylx}
		</if>
		<if test="fsrq != null and '' != fsrq">  
			and fsrq = #{fsrq}
		</if>
		<if test="status != 0">  
			and status = #{status}
		</if>
	</select>
	
	<select id="selectP2PTsjyxxPageList" resultMap="p2pTsjyxxResultMap">
		<include refid="select_all_sql" />
		where org_code = #{p2pTsjyxx.orgCode}
		<if test="p2pTsjyxx.xm != null and '' != p2pTsjyxx.xm">  
			and xm like '%${p2pTsjyxx.xm}%'
		</if>
		<if test="p2pTsjyxx.zjhm != null and '' != p2pTsjyxx.zjhm">  
			and zjhm like '%${p2pTsjyxx.zjhm}%'
		</if>
		<if test="p2pTsjyxx.ywh != null and '' != p2pTsjyxx.ywh">  
			and ywh like '%${p2pTsjyxx.ywh}%'
		</if>
		<if test="p2pTsjyxx.tsjylx != null and '' != p2pTsjyxx.tsjylx">  
			and tsjylx = #{p2pTsjyxx.tsjylx}
		</if>
		<if test="p2pTsjyxx.fsrq != null and '' != p2pTsjyxx.fsrq">  
			and fsrq = #{p2pTsjyxx.fsrq}
		</if>
		<if test="p2pTsjyxx.status != 0">  
			and status = #{p2pTsjyxx.status}
		</if>
		order by create_time desc limit #{pm.pageSize} offset #{pm.startCount}
	</select>
	
	<select id="selectP2PTsjyxxById" parameterType="int" resultMap="p2pTsjyxxResultMap">
		<include refid="select_all_sql" />
		where id = #{id}
	</select>
	
	<select id="selectP2PTsjyxxCountForUnique" parameterType="map" resultType="int">
		select count(1) from p2p_tsjyxx where zjlx = #{zjlx} and zjhm = #{zjhm} and fsrq = #{fsrq} and org_code = #{orgCode}
	</select>
	
	<insert id="insertP2PTsjyxx" parameterType="cn.creditloans.core.entity.p2p.P2PTsjyxx">
		<selectKey order="AFTER" keyProperty="id" resultType="java.lang.Integer">
			SELECT currval('p2p_tsjyxx_id_seq')
		</selectKey>
		insert into p2p_tsjyxx (xm, zjlx, zjhm, ywh, tsjylx, fsrq, bgys, fsje,
		mxxx, status, user_id, org_code, create_time, update_time)
		values (#{xm}, #{zjlx}, #{zjhm}, #{ywh}, #{tsjylx}, #{fsrq}, #{bgys},
		#{fsje}, #{mxxx}, #{status}, #{userId}, #{orgCode}, now(), now())
	</insert>
	
	<update id="updateP2PTsjyxx" parameterType="cn.creditloans.core.entity.p2p.P2PTsjyxx">
		update p2p_tsjyxx set xm=#{xm}, zjlx=#{zjlx}, zjhm=#{zjhm}, ywh=#{ywh},
		tsjylx=#{tsjylx}, fsrq=#{fsrq}, bgys=#{bgys}, fsje=#{fsje},
		mxxx=#{mxxx}, status=#{status}, user_id=#{userId},
		org_code=#{orgCode}, update_time=now() where id=#{id}
	</update>
	
	<delete id="deleteP2PTsjyxxById" parameterType="int">
		delete from p2p_tsjyxx where id=#{id}
	</delete>
</mapper>